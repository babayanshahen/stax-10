function sc_pb_app_process(e){function t(){if(e(".sc-pb-element").length>0)var t=e(".sc-pb-element");else t=e('img[src*="/products/"][src*="/cdn.shopify.com/s/files/"]').filter('[src*=".jpg"],[src*=".jpeg"],[src*=".png"]');var a,i=0;return t.each(function(e,t){var n=t.width;n>i&&(i=n,a=t)}),a}function a(e){var t=(e=new Date(e)).getFullYear();return e.getMonth()+1+"/"+e.getDate()+"/"+t}if(search_result=function(t){for(var a in SCPB.productListShopify={},e.each(t.Items,function(e,t){SCPB.productListShopify[t.handle]=t}),SCPB.imgElements){var i=SCPB.imgElements[a],n=e("img",i),r=n.parents(":not(a)").first();r.addClass("sc-badge-main"),n.before('<div class="sc-badge-container sc-badge-collection">'),objElement=e(i),e(".sc-badge-collection",r).css({width:objElement.width(),height:objElement.height(),"margin-left":SCPB.getBadgeMarginW(objElement),"margin-right":SCPB.getBadgeMarginW(objElement),"margin-top":SCPB.getBadgeMarginH(objElement),"margin-bottom":SCPB.getBadgeMarginH(objElement),padding:SCPB.getBadgePadding(objElement)});var o=SCPB.productListShopify[a];SCPB.activeVariant=o.variants[0],SCPB.showBadgeForProduct(o,i)}},SCPB.getVariantId=function(){var t=!1;"object"==typeof Shopify&&"function"==typeof Shopify.urlParam&&(t=Shopify.urlParam("variant"));var a="number"==typeof product_select_index?product_select_index:0;return t||(e("form[action='/cart/add'] select[name='id'] option:selected").length?t=e("form[action='/cart/add'] select[name='id'] option:selected")[a].value:e("form[action='/cart/add'] input[name='id']").length&&(t=e("form[action='/cart/add'] input[name='id']")[a].value,console.log("v",t))),t},SCPB.validateBadgeConditions=function(t,i){var n=!0;if(console.log("validation-start"),"yes"==t.on_sale){if(n)if(SCPB.activeVariant.hasOwnProperty("compare_at_price")&&null!=SCPB.activeVariant.compare_at_price){n=!1;var r=SCPB.activeVariant.compare_at_price-SCPB.activeVariant.price;parseFloat(t.min_discount_amount)&&r>=100*parseFloat(t.min_discount_amount)&&(n=!0),parseFloat(t.min_discount_percentage)&&r/SCPB.activeVariant.compare_at_price*100>=parseFloat(t.min_discount_percentage)&&(n=!0)}else n=!1}else t.on_sale;if(n||console.log("on_sale"),"yes"==t.new){if((t.from_time||t.to_time)&&n&&(""!=t.from_time.trim()&&Date.parse(a(i.published_at))<Date.parse(t.from_time)&&(n=!1),""!=t.to_time.trim()&&n&&Date.parse(a(i.published_at))>Date.parse(t.to_time)&&(n=!1)),parseInt(t.last_days)&&n&&""==t.from_time.trim()&&""==t.to_time.trim()||!n&&(""!=t.from_time.trim()||""!=t.to_time.trim())){var o=new Date(i.published_at),s=new Date;o.setDate(o.getDate()+parseInt(t.last_days)),o<s?n=!1:n||(n=!0)}}else if("no"==t.new&&n&&((t.from_time||t.to_time)&&n&&(""!=t.from_time.trim()&&Date.parse(a(i.published_at))>=Date.parse(t.from_time)&&(n=!1),""!=t.to_time.trim()&&n&&Date.parse(a(i.published_at))<=Date.parse(t.to_time)&&(n=!1)),parseInt(t.last_days)&&n&&""==t.from_time.trim()&&""==t.to_time.trim()||!n&&(""!=t.from_time.trim()||""!=t.to_time.trim()))){o=new Date(i.published_at),s=Date.now();o.setDate(o.getDate()+parseInt(t.last_days)),o>=s?n=!1:n||(n=!0)}if(n||console.log("new"),t.collections&&n){n=!1;for(var c=t.collections.split(","),p=0;p<i.collections.length;p++){var d=i.collections[p];if(e.inArray(d+"",c)>=0){n=!0;break}}}if(n||console.log("collection"),"avail"==t.stock){if(n){n=!1;for(p=0;p<i.variants.length;p++){if((g=i.variants[p]).inventory_quantity>0||!g.hasOwnProperty("inventory_management")){n=!0;break}}}}else if("not_avail"==t.stock){if(n)for(p=0;p<i.variants.length;p++){if((g=i.variants[p]).inventory_quantity>0||!g.hasOwnProperty("inventory_management")){n=!1;break}}}else if("low_stock"==t.stock&&n){n=!1,min_qty=t.stock_min_qty?parseInt(t.stock_min_qty):1,min_qty&&min_qty<=0&&(min_qty=1);for(p=0;p<i.variants.length;p++){var g;if((g=i.variants[p]).inventory_quantity>0&&g.inventory_quantity<=min_qty&&g.hasOwnProperty("inventory_management")){n=!0;break}}}if(n||console.log("stock"),(t.hasOwnProperty("from_price")||t.hasOwnProperty("to_price"))&&n&&(t.hasOwnProperty("from_price")&&""!=t.from_price&&SCPB.activeVariant.price<100*parseFloat(t.from_price)&&(n=!1),t.hasOwnProperty("to_price")&&""!=t.to_price&&n&&1==n&&SCPB.activeVariant.price>100*parseFloat(t.to_price)&&(n=!1)),n||console.log("from_price - to_price: "),"ex_sel_variant"==t.v_option){if(n){var l=t.variant_list.split(",");-1!=e.inArray(SCPB.activeVariant.id+"",l)&&(n=!1)}}else if("sel_variant_only"==t.v_option&&n){n=!1;l=t.variant_list.split(",");-1!=e.inArray(SCPB.activeVariant.id+"",l)&&(n=!0)}return n||console.log("V_option"),console.log("validation-end: ",n),n},SCPB.showBadge=function(t,a,i,n,r,o,s,c,p,d,g){var l;if((l=a?e(".sc-badge-container .sc-badge-img[data-sc-badge-id='"+i+"']",a):e(".sc-badge-container .sc-badge-img[data-sc-badge-id='"+i+"']")).length>0)l.first().show();else{var m='<div data-sc-badge-id="'+i+'" class="sc-badge-img '+n+'" style="background-size: cover; background-image: url(\'/apps/product-badge'+o+"'); width: "+(s||30)+("true"==p?"px":"%")+"; height: "+(c||30)+("true"==p?"px":"%")+";"+g+' ">';if(r){var _=r;if(_.indexOf("##SAVE_PERCENTAGE##")>=0){var u=0;SCPB.activeVariant.hasOwnProperty("compare_at_price")&&SCPB.activeVariant.price<SCPB.activeVariant.compare_at_price&&(u=(SCPB.activeVariant.compare_at_price-SCPB.activeVariant.price)/SCPB.activeVariant.compare_at_price*100,u=Math.round(100*u)/100),_=_.replace("##SAVE_PERCENTAGE##",u)}if(_.indexOf("##SAVE_AMOUNT##")>=0){var f=0;SCPB.activeVariant.hasOwnProperty("compare_at_price")&&SCPB.activeVariant.price<SCPB.activeVariant.compare_at_price&&(f=(SCPB.activeVariant.compare_at_price-SCPB.activeVariant.price)/100);var v=sc_pb_money_format.replace("{{amount}}",f);_=_.replace("##SAVE_AMOUNT##",v)}if(_.indexOf("##PRODUCT_PRICE##")>=0){var P=sc_pb_money_format.replace("{{amount}}",SCPB.activeVariant.price/100);_=_.replace("##PRODUCT_PRICE##",P)}if(_.indexOf("##NEW_DAYS##")>=0){var h=(Date.parse(t.published_at)-new Date)/864e5;_=_.replace("##NEW_DAYS##",h)}_.indexOf("##PRODUCT_SKU##")>=0&&(SCPB.activeVariant.hasOwnProperty("sku")?""!=SCPB.activeVariant.sku&&(_=_.replace("##PRODUCT_SKU##",SCPB.activeVariant.sku)):_=""),_.indexOf("##PRODUCT_QUANTITY##")>=0&&(SCPB.activeVariant.hasOwnProperty("inventory_quantity")&&SCPB.activeVariant.hasOwnProperty("inventory_management")?SCPB.activeVariant.inventory_quantity>0&&SCPB.activeVariant.inventory_management&&(_=_.replace("##PRODUCT_QUANTITY##",SCPB.activeVariant.inventory_quantity)):_="");m+='<span class="sc-badge-content" style="'+(d||"")+'">'+_+"</span>"}m+="</div>","product"==SCPB.page?e(".sc-badge-container").append(m):e(".sc-badge-container",a).append(m)}},SCPB.showBadgeForProduct=function(e,t){var a=!1,i=SCPB.badges;for(var n in i){var r=i[n],o=r.logics;if(a)break;(a="1"===r.enabled&&SCPB.validateBadgeConditions(o,e))&&("product"==SCPB.page?SCPB.showBadge(e,t,r.id,r.product.imgOptions.position,r.product.imgOptions.text,r.product.imgOptions.url,r.product.imgOptions.badge_width,r.product.imgOptions.badge_height,r.product.imgOptions.in_px,r.product.imgOptions.text_styles,r.product.imgOptions.badge_styles):SCPB.showBadge(e,t,r.id,r.collection.imgOptions.position,r.collection.imgOptions.text,r.collection.imgOptions.url,r.collection.imgOptions.badge_width,r.collection.imgOptions.badge_height,r.collection.imgOptions.in_px,r.collection.imgOptions.text_styles,r.collection.imgOptions.badge_styles))}return null},SCPB.getBadgeMarginW=function(e,t){e.outerWidth(),e.innerWidth(),e.innerWidth(),e.width();return(e.outerWidth(!0)-e.outerWidth())/2},SCPB.getBadgeMarginH=function(e,t){e.outerHeight(),e.innerHeight(),e.innerHeight(),e.height();return(e.outerHeight(!0)-e.outerHeight())/2},SCPB.getBadgePadding=function(e,t){e.outerWidth(),e.innerWidth();var a=e.innerWidth()-e.width();e.outerWidth(!0),e.outerWidth();return a},SCPB.bindBadges=function(){if("product"===SCPB.page){e(".sc-badge-container .sc-badge-img").hide();var a=t(),i=e(a);if(i.parents(":not(a)").first().addClass("sc-badge-main"),i){i.before('<div class="sc-badge-container">'),e(".sc-badge-container").css({width:i.width(),height:i.height(),"margin-left":SCPB.getBadgeMarginW(i),"margin-right":SCPB.getBadgeMarginW(i),"margin-top":SCPB.getBadgeMarginH(i),"margin-bottom":SCPB.getBadgeMarginH(i),padding:SCPB.getBadgePadding(i)});var n=null,r=SCPB.getVariantId();if(r){for(var o=SCPB.product,s=0;s<o.variants.length;s++)if(r==o.variants[s].id){n=o.variants[s];break}}else n=SCPB.product.variants[0];SCPB.activeVariant=n,null!=n&&SCPB.showBadgeForProduct(o,a)}}else{SCPB.imgElements=function(){if(e(".sc-pb-element").length>0)var t=e(".sc-pb-element");else t=e('a[href*="/products/"]:not(form a[href*="/products/"]):not(.related-products a[href*="/products/"])').has('img[src*="/products/"], img[src*="/no-image"]');var a={};return t.each(function(t,i){var n=e(i).attr("href").split("/"),r=n[n.length-1].split("?")[0];a[r]=i}),a}();var c="";for(var p in SCPB.imgElements)c.length>0&&(c+=" OR "),c+='handle:"'+p+'"';e.getScript("/search?q="+c+"&view=sc-pb-front-25052016")}},SCPB.page=SCPB.page.split(".")[0],e.inArray(SCPB.page,["index","collection","product"])>=0)if("undefined"!=typeof Storage){if(sessionStorage.sc_pb_badges&&(console.log("add badge from session"),SCPB.badges=JSON.parse(sessionStorage.sc_pb_badges),SCPB.bindBadges()),sessionStorage.sc_pb_settings){var i=JSON.parse(sessionStorage.sc_pb_settings);console.log("add settings from session"),e("body").append("<style>"+i.custom_css+"</style>")}}else e.ajax({type:"GET",url:"/apps/product-badge/app-front/app-front/get_all_badges",dataType:"json",async:!1,success:function(e,t,a){"notice"==e.type&&(SCPB.badges=JSON.parse(e.text),SCPB.bindBadges())}}),e.ajax({type:"GET",url:"/apps/product-badge/app-front/app-front/get_settings",dataType:"json",async:!1,success:function(t,a,i){"notice"==t.type&&(t=JSON.parse(t.text),e("body").append("<style>"+t.custom_css+"</style>"))}});SCPB.update_variant=function(a){SCPB.activeVariant=a,e(".sc-badge-container").empty();var i=t();SCPB.showBadgeForProduct(SCPB.product,i)}}